<!DOCTYPE html>
<style>
  div.tooltip {
  color: #222; 
  background: #fff; 
  padding: .5em; 
  text-shadow: #f5f5f5 0 1px 0;
  border-radius: 2px; 
  box-shadow: 0px 0px 2px 0px #a6a6a6; 
  opacity: 0.9; 
  position: absolute;
}
</style>
<svg width="960" height="500"></svg>
<script src="https://d3js.org/d3.v4.min.js"></script>

<script>

function replaceAll(str, find, replace) {
    return str.replace(new RegExp(find, 'g'), replace);
}

var svg = d3.select("svg"),
    margin = {top: 20, right: 20, bottom: 30, left: 50},
    width = +svg.attr("width") - margin.left - margin.right,
    height = +svg.attr("height") - margin.top - margin.bottom,
    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

     

var parseTime = d3.timeParse("%d-%b-%y");

var parseTimeJson = d3.timeParse("%Y");

var x = d3.scaleTime()
    .rangeRound([0, width]);

var y = d3.scaleLinear()
    .rangeRound([height, 0]);

var line = d3.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y(d[1]); });

svg.append('text')
    .attr('x', 100)
    .attr('y', 100)
    .attr('id', 'label')
    .style('font-family', 'Helvetica')
    .style('font-size', '12px')
    .text('');


//var c10 = d3.scale.category10();
//var colorscat = d3.scale.category10();
//var colorscat = d3.scaleOrdinal({ "name" : "schemeCategory10", "n" : 10}.name)
var f = d3.schemeCategory10;
console.log(f[0])


d3.json('praetorian_by_country.json',

  function(error, data){
    if (error) throw error;
    
    for (a in data){
      country_data = data[a]
      for (c in country_data){
        data[a][c][0] = parseTimeJson(data[a][c][0]);
        data[a][c][1] = +data[a][c][1]
      }    
    };
     // console.log(data["United States"])
      //console.log('hi')
    //usdata = data["United States"]
    x.domain(d3.extent(usdata, function(d) { return d[0]; }));
  y.domain([0, 100])//d3.extent(usdata, function(d) { return d[1]; }));

  g.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x))
    .select(".domain")
      .remove();

  g.append("g")
      .call(d3.axisLeft(y))
    .append("text")
      .attr("fill", "#000")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", "0.71em")
      .attr("text-anchor", "end")
      .text("Praetorian Militarization");
var continents = ['Asia', 'Africa', 'Europe', 'Oceania', 'South America', 'North America']
for (country in data){
 // console.log(country)
  g.append("path")
      .datum(data[country])
      .attr("fill", "none")
      .attr("stroke", function(d){
        console.log(d[0])
        if (d[0][2] == 'Asia'){
          return f[0]
        }
        if (d[0][2] == 'Africa'){
          return f[1]
        }
        if (d[0][2] == 'Oceania'){
          return f[2]
        }
        if (d[0][2] == 'Europe'){
          return f[3]
        }
        if (d[0][2] == 'North America'){
          return f[4]
        }
        if (d[0][2] == 'South America'){
          return f[5]
        }
        console.log('he')
        return f[6]
      })
      .attr("stroke-linejoin", "round")
      .attr("stroke-linecap", "round")
      .attr("stroke-width", 1.5)
      .attr("d", line)
      .attr('class', function(d){
        return d[0][2] + ' country'
      })

      .attr('id', replaceAll(country, ' ', '_'))
      .on('mouseover', function(d){
        var coordinates = [0, 0];
        coordinates = d3.mouse(this);
        var x = coordinates[0];
        var y = coordinates[1];

        d3.select('#label')
          .attr('x', x)
          .attr('y', y)
          .text(d3.select(this).attr('id'))
      })
      .on('mouseout', function(d){

      });
    }
    d3.selectAll('path')
      .attr('display', function(d){
        c = d3.select(this).attr('id')

        if(c == 'Afghanistan' || c == "Congo_Democratic_Republic" || c == 'India' || c == "Kenya" || c == "Pakistan" || c == "Saudi_Arabia" || c == "Tajikistan" || c == "Uganda"){
          return ""
        }
        else{
          return "none"
        }
      })
  });

//console.log(parseTimeJson('1993'))

</script>